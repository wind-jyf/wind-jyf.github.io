<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="实现一个简易的VueHTML文件引入12345678910111213141516171819202122232425262728293031323334353637383940&lt;!DOCTYPE html&gt;&lt;html lang&#x3D;&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;    &lt;meta name&#x3D;&quot;viewp">
<meta property="og:type" content="article">
<meta property="og:title" content="【Vue源码】实现一个简易的Vue">
<meta property="og:url" content="http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/index.html">
<meta property="og:site_name" content="jyf blog">
<meta property="og:description" content="实现一个简易的VueHTML文件引入12345678910111213141516171819202122232425262728293031323334353637383940&lt;!DOCTYPE html&gt;&lt;html lang&#x3D;&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;    &lt;meta name&#x3D;&quot;viewp">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-04-06T14:35:54.603Z">
<meta property="article:modified_time" content="2020-04-06T15:25:23.754Z">
<meta property="article:author" content="wind-jyf">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>【Vue源码】实现一个简易的Vue</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/wind-jyf" target="_blank" rel="noopener">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/04/07/%E3%80%90JS%E3%80%91JavaScript%E7%9A%84%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E5%92%8C%E6%89%A7%E8%A1%8C%E6%A0%88/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li>
        
        
        <li><a class="icon" href="/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AD%A6%E4%B9%A0Vue%E6%BA%90%E7%A0%81%E7%AC%AC%E4%B8%80%E5%A4%A9/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/" target="_blank" rel="noopener"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&text=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&is_video=false&description=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【Vue源码】实现一个简易的Vue&body=Check out this article: http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&name=【Vue源码】实现一个简易的Vue&description=" target="_blank" rel="noopener"><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#实现一个简易的Vue"><span class="toc-number">1.</span> <span class="toc-text">实现一个简易的Vue</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML文件引入"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">HTML文件引入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MVue入口"><span class="toc-number">1.0.0.2.</span> <span class="toc-text">MVue入口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Observer"><span class="toc-number">1.0.0.3.</span> <span class="toc-text">Observer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dep"><span class="toc-number">1.0.0.4.</span> <span class="toc-text">dep</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#watcher"><span class="toc-number">1.0.0.5.</span> <span class="toc-text">watcher</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Compile"><span class="toc-number">1.0.0.6.</span> <span class="toc-text">Compile</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#compileUtil"><span class="toc-number">1.0.0.6.1.</span> <span class="toc-text">compileUtil</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#总结"><span class="toc-number">1.0.0.7.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#学习时的疑惑"><span class="toc-number">1.0.0.8.</span> <span class="toc-text">学习时的疑惑</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        【Vue源码】实现一个简易的Vue
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">jyf blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2020-04-06T14:35:54.603Z" itemprop="datePublished">2020-04-06</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="实现一个简易的Vue"><a href="#实现一个简易的Vue" class="headerlink" title="实现一个简易的Vue"></a>实现一个简易的Vue</h1><h4 id="HTML文件引入"><a href="#HTML文件引入" class="headerlink" title="HTML文件引入"></a>HTML文件引入</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;person.name&#125;&#125; -----&#123;&#123;person.age&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;person.fav&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;msg&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-text</span> = <span class="string">'msg'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span> = <span class="string">'htmlStr'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span> = <span class="string">'msg'</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./Observer.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./Mvue.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> vm = <span class="keyword">new</span> MVue(&#123;</span></span><br><span class="line"><span class="actionscript">            el:<span class="string">'#app'</span>,</span></span><br><span class="line">            data:&#123;</span><br><span class="line">                person:&#123;</span><br><span class="line"><span class="actionscript">                    name:<span class="string">'jyf'</span>,</span></span><br><span class="line">                    age:20,</span><br><span class="line"><span class="actionscript">                    fav:<span class="string">'姑娘'</span></span></span><br><span class="line">                &#125;,</span><br><span class="line"><span class="actionscript">                msg:<span class="string">'学习MVVM实现原理'</span>,</span></span><br><span class="line"><span class="actionscript">                htmlStr:<span class="string">'htmlStr'</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="MVue入口"><a href="#MVue入口" class="headerlink" title="MVue入口"></a>MVue入口</h4><ol>
<li>首先，要新建一个类MVue</li>
<li>将其参数初始化</li>
<li>new Observer</li>
<li>new Compile</li>
<li>设置相关代理</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MVue</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(options)&#123;</span><br><span class="line">        <span class="keyword">this</span>.$el = options.el;</span><br><span class="line">        <span class="keyword">this</span>.$data = options.data;</span><br><span class="line">        <span class="keyword">this</span>.$options = options;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.$el)&#123;</span><br><span class="line">            <span class="comment">//1.实现一个数据的观察者</span></span><br><span class="line">            <span class="keyword">new</span> Observer(<span class="keyword">this</span>.$data);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//2.实现指令的解析器</span></span><br><span class="line">            <span class="keyword">new</span> Compile(<span class="keyword">this</span>.$el,<span class="keyword">this</span>);<span class="comment">//把挂载的节点传入以及整个MVue类</span></span><br><span class="line">            <span class="keyword">this</span>.proxyData(<span class="keyword">this</span>.$data);<span class="comment">//设置相关代理，即使用this可以代替this.$data</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    proxyData(data)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> key <span class="keyword">in</span> data)&#123;</span><br><span class="line">            <span class="built_in">Object</span>.defineProperty(<span class="keyword">this</span>,key,&#123;</span><br><span class="line">                <span class="keyword">get</span>()&#123;</span><br><span class="line">                    <span class="keyword">return</span> data[key]</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="keyword">set</span>(newVal)&#123;</span><br><span class="line">                    data[key] = newVal;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h4><ol>
<li>主要进行数据拦截</li>
<li>并且在每次get时，向dep(观察者收集器)中添加观察者</li>
<li>在set时，通知dep去告诉观察者更改数据，再驱动视图进行更改</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(data)&#123;</span><br><span class="line">        <span class="keyword">this</span>.observer(data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    observer(data)&#123;  <span class="comment">//如果是对象的话，就逐层进行数据代理</span></span><br><span class="line">        <span class="keyword">if</span>(data &amp;&amp; <span class="keyword">typeof</span> data === <span class="string">'object'</span>)&#123;</span><br><span class="line">            <span class="built_in">Object</span>.keys(data).forEach(<span class="function"><span class="params">key</span>=&gt;</span>&#123;<span class="comment">//遍历第一层的key</span></span><br><span class="line">                <span class="keyword">this</span>.defineReactive(data,key,data[key]);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    defineReactive(data,key,value)&#123;   <span class="comment">//设置相关代理</span></span><br><span class="line">        <span class="comment">//递归遍历</span></span><br><span class="line">        <span class="keyword">this</span>.observer(value);</span><br><span class="line">        <span class="keyword">const</span> dep = <span class="keyword">new</span> Dep();</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(data,key,&#123;</span><br><span class="line">            enumerable:<span class="literal">true</span>,</span><br><span class="line">            configurable:<span class="literal">false</span>,</span><br><span class="line">            <span class="keyword">get</span>()&#123;</span><br><span class="line">                <span class="comment">//订阅数据变化时，往dep中添加观察者</span></span><br><span class="line">                Dep.target &amp;&amp; dep.addSub(Dep.target);</span><br><span class="line">                <span class="keyword">return</span> value;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>:(newVal)=&gt;&#123;</span><br><span class="line">                <span class="keyword">this</span>.observer(newVal);<span class="comment">//如果新值是一个对象，需要将对象加入监听</span></span><br><span class="line">                <span class="keyword">if</span>(newVal !== value)&#123;</span><br><span class="line">                    value = newVal;</span><br><span class="line">                    <span class="comment">//告诉Dep通知变化</span></span><br><span class="line">                    dep.notify();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>刚刚说，在进行 get时，需要用到dep，在set时，同样需要用到dep，dep旧仿佛是observe和watcher之间的一个桥梁，那么dep是如何实现的呢，以及watcher是如何实现的呢？</p>
<h4 id="dep"><a href="#dep" class="headerlink" title="dep"></a>dep</h4><ol>
<li>dep作为一个watcher收集器，要有一个数组进行存放</li>
<li>拥有相应的方法去添加观察者</li>
<li>拥有相应的方法去通知观察者</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dep</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="comment">//收集watcher</span></span><br><span class="line">        <span class="keyword">this</span>.subs = [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//收集观察者</span></span><br><span class="line">    addSub(watcher)&#123;</span><br><span class="line">        <span class="keyword">this</span>.subs.push(watcher);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//通知观察者更新</span></span><br><span class="line">    notify()&#123;</span><br><span class="line">        <span class="keyword">this</span>.subs.forEach(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">            item.update()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="watcher"><a href="#watcher" class="headerlink" title="watcher"></a>watcher</h4><ol>
<li>观察者需要的通知更新视图，所以和Compile有一定关系，当然也要和dep相关联</li>
<li>在获得旧值时，将当前watcher保存起来，由于get了值，会触发observe，通知dep添加watcher，添加之后，再讲保存的空间设为null</li>
<li>在进行更新视图时，需要先判断值是否发生变化，如果发生变化，我们就设置相关的回调把新值给Compile</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">watcher</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(vm,expr,cb)&#123;</span><br><span class="line">        <span class="keyword">this</span>.vm = vm;</span><br><span class="line">        <span class="keyword">this</span>.expr = expr;</span><br><span class="line">        <span class="keyword">this</span>.cb = cb;</span><br><span class="line">        <span class="comment">//先把旧值保存起来</span></span><br><span class="line">        <span class="keyword">this</span>.oldVal = <span class="keyword">this</span>.getOldVal();<span class="comment">//只要new watcher就会把此watcher放入dep</span></span><br><span class="line">    &#125;</span><br><span class="line">    update()&#123;</span><br><span class="line">        <span class="comment">//1.判断新值和旧制是否有变化</span></span><br><span class="line">        <span class="keyword">const</span> newVal = compileUtil.getVal(<span class="keyword">this</span>.expr,<span class="keyword">this</span>.vm);<span class="comment">//获取相应的值</span></span><br><span class="line">        <span class="keyword">if</span>(newVal !== <span class="keyword">this</span>.oldVal)&#123;</span><br><span class="line">            <span class="keyword">this</span>.cb(newVal);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    getOldVal()&#123;<span class="comment">//获得值</span></span><br><span class="line">        Dep.target = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">const</span> oldVal = compileUtil.getVal(<span class="keyword">this</span>.expr,<span class="keyword">this</span>.vm);</span><br><span class="line">        Dep.target = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> oldVal;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于每一个属性，每一个值都需要对应相关的watcher，所以我们应该在编译每一个标签时，进行new watcher，下面我们来看一下Compile是如何实现的，也是我认为整个过程中最麻烦的一步。</p>
<h4 id="Compile"><a href="#Compile" class="headerlink" title="Compile"></a>Compile</h4><ol>
<li>将文档碎片化</li>
<li>获取整个dom元素</li>
<li>对于元素节点和文本节点分别处理</li>
<li>对其调用相应的节点编译方法进行编译</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Compile</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(el,vm)&#123;</span><br><span class="line">        <span class="keyword">this</span>.el = <span class="keyword">this</span>.isElementNode(el)?el:<span class="built_in">document</span>.querySelector(el);<span class="comment">//获取整个节点对象</span></span><br><span class="line">        <span class="keyword">this</span>.vm = vm;<span class="comment">//获取整个vue对象</span></span><br><span class="line">        <span class="comment">//1.获取当前的文档碎片对象,放入内存中，减少页面的回流以及重绘</span></span><br><span class="line">        <span class="keyword">const</span> fragment = <span class="keyword">this</span>.node2Fragment(<span class="keyword">this</span>.el);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//2.编译模板</span></span><br><span class="line">        <span class="keyword">this</span>.compile(fragment);</span><br><span class="line">        <span class="comment">//追加子元素到根元素</span></span><br><span class="line">        <span class="keyword">this</span>.el.appendChild(fragment);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.el);</span><br><span class="line">    &#125;</span><br><span class="line">    compile(fragment)&#123;</span><br><span class="line">        <span class="comment">//1.获取每一个子节点</span></span><br><span class="line">        <span class="keyword">const</span> childNodes = fragment.childNodes;</span><br><span class="line">        [...childNodes].forEach(<span class="function"><span class="params">child</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">//console.log(child);</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.isElementNode(child))&#123;<span class="comment">//是元素节点,编译元素节点</span></span><br><span class="line">                <span class="comment">//console.log(child)</span></span><br><span class="line">                <span class="keyword">this</span>.compileElement(child);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//文本节点</span></span><br><span class="line">                <span class="comment">//编译文本节点</span></span><br><span class="line">                <span class="comment">//console.log(child);</span></span><br><span class="line">                <span class="keyword">this</span>.compileText(child);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(child.childNodes &amp;&amp; child.childNodes.length)&#123;</span><br><span class="line">                <span class="keyword">this</span>.compile(child);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    compileElement(node)&#123;<span class="comment">//对元素节点进行编译，主要是为了取出相关指令</span></span><br><span class="line">        <span class="built_in">console</span>.log(node);</span><br><span class="line">        <span class="keyword">const</span> attributes =  node.attributes;</span><br><span class="line">        <span class="comment">//console.log(attributes);</span></span><br><span class="line">        [...attributes].forEach(<span class="function"><span class="params">attr</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">//console.log(attr);</span></span><br><span class="line">            <span class="keyword">const</span> &#123;name,value&#125; = attr;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.isDirective(name))&#123;<span class="comment">//是一个指令</span></span><br><span class="line">                <span class="keyword">const</span> [,dirctive] = name.split(<span class="string">'-'</span>)<span class="comment">//text html model on:click</span></span><br><span class="line">                <span class="keyword">const</span> [dirName,eventName] = dirctive.split(<span class="string">':'</span>); <span class="comment">//对于双重的进行分割</span></span><br><span class="line">                <span class="comment">//更新数据 数据驱动视图</span></span><br><span class="line">                compileUtil[dirName](node,value,<span class="keyword">this</span>.vm,eventName)</span><br><span class="line"></span><br><span class="line">                <span class="comment">//删除指令的标签上的属性</span></span><br><span class="line">                node.removeAttribute(<span class="string">'v-'</span>+dirctive);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    compileText(node)&#123;<span class="comment">//对文本节点进行编译</span></span><br><span class="line">        <span class="comment">//&#123;&#123;&#125;&#125;</span></span><br><span class="line">        <span class="keyword">const</span> content = node.textContent;</span><br><span class="line">        <span class="keyword">if</span>(<span class="regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/</span>.test(content))&#123;<span class="comment">//匹配双大括号</span></span><br><span class="line">            compileUtil[<span class="string">'text'</span>](node,content,<span class="keyword">this</span>.vm);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    isDirective(attrName)&#123; <span class="comment">//判断标签属性是否为v-开头</span></span><br><span class="line">        <span class="keyword">return</span> attrName.startsWith(<span class="string">'v-'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    node2Fragment(el)&#123;<span class="comment">//此时传入的是根节点</span></span><br><span class="line">        <span class="comment">//创建文档碎片，将子节点循环放入</span></span><br><span class="line">        <span class="keyword">const</span> f = <span class="built_in">document</span>.createDocumentFragment();</span><br><span class="line">        <span class="keyword">let</span> firstChild;</span><br><span class="line">        <span class="keyword">while</span>(firstChild = el.firstChild)&#123;</span><br><span class="line">            f.appendChild(firstChild);<span class="comment">//appendChild会进行自动移动进行遍历</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    &#125;</span><br><span class="line">    isElementNode(node)&#123;<span class="comment">//判断是否为元素节点</span></span><br><span class="line">        <span class="keyword">return</span> node.nodeType === <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="compileUtil"><a href="#compileUtil" class="headerlink" title="compileUtil"></a>compileUtil</h5><ol>
<li>提供相应元素编译的方法</li>
<li>并在编译的同时，设置watcher，以及在每次watcher回调后，更新视图</li>
<li>在model中设置双向数据绑定</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> compileUtil = &#123;</span><br><span class="line">    getVal(expr,vm)&#123;<span class="comment">//获取数据</span></span><br><span class="line">        <span class="keyword">return</span> expr.split(<span class="string">'.'</span>).reduce(<span class="function">(<span class="params">data,currentVal</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> data[currentVal]</span><br><span class="line">        &#125;,vm.$data)</span><br><span class="line">    &#125;,</span><br><span class="line">    setVal(expr,vm,inputVal)&#123;</span><br><span class="line">        <span class="keyword">return</span> expr.split(<span class="string">'.'</span>).reduce(<span class="function">(<span class="params">data,currentVal</span>)=&gt;</span>&#123;</span><br><span class="line">            data[currentVal] = inputVal;</span><br><span class="line">        &#125;,vm.$data)</span><br><span class="line">    &#125;,</span><br><span class="line">    getContentVal(expr,vm)&#123;</span><br><span class="line">        value = expr.replace(<span class="regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/g</span>,(...args)=&gt;&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.getVal(args[<span class="number">1</span>],vm);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    text(node,expr,vm)&#123;<span class="comment">//expr:msg,当然,expr也有可能是一个对象</span></span><br><span class="line">        <span class="keyword">let</span> value;</span><br><span class="line">        <span class="keyword">if</span>(expr.indexOf(<span class="string">'&#123;&#123;'</span>) !=<span class="number">-1</span>)&#123;<span class="comment">//处理双大括号</span></span><br><span class="line">            value = expr.replace(<span class="regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/g</span>,(...args)=&gt;&#123;</span><br><span class="line">                <span class="keyword">new</span> watcher(vm,args[<span class="number">1</span>],()=&gt;&#123;</span><br><span class="line">                    <span class="keyword">this</span>.updater.textUpdater(node,<span class="keyword">this</span>.getContentVal(expr,vm));</span><br><span class="line">                &#125;)</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.getVal(args[<span class="number">1</span>],vm);</span><br><span class="line">            &#125;)                                                                           </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            value = <span class="keyword">this</span>.getVal(expr,vm);<span class="comment">//取到data中的相关数据</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.updater.textUpdater(node,value);</span><br><span class="line">    &#125;,</span><br><span class="line">    html(node,expr,vm)&#123;</span><br><span class="line">        <span class="keyword">const</span> value = <span class="keyword">this</span>.getVal(expr,vm);</span><br><span class="line">        <span class="keyword">new</span> watcher(vm,expr,(newVal)=&gt;&#123;</span><br><span class="line">            <span class="keyword">this</span>.updater.htmlUpdater(node,newVal);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.updater.htmlUpdater(node,value);</span><br><span class="line">    &#125;,</span><br><span class="line">    model(node,expr,vm)&#123;</span><br><span class="line">        <span class="keyword">const</span> value = <span class="keyword">this</span>.getVal(expr,vm);</span><br><span class="line">        <span class="comment">//绑定更新函数 数据驱动视图</span></span><br><span class="line">        <span class="keyword">new</span> watcher(vm,expr,(newVal)=&gt;&#123;</span><br><span class="line">            <span class="keyword">this</span>.updater.modelUpdater(node,newVal);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//视图-&gt;数据-&gt;视图</span></span><br><span class="line">        node.addEventListener(<span class="string">'input'</span>,e=&gt;&#123;<span class="comment">//监听input的输入事件</span></span><br><span class="line">            <span class="comment">//设置值</span></span><br><span class="line">            <span class="keyword">this</span>.setVal(expr,vm,e.target.value);</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">this</span>.updater.modelUpdater(node,value);</span><br><span class="line">    &#125;,</span><br><span class="line">    on(node,expr,vm,eventName)&#123;</span><br><span class="line">        <span class="keyword">let</span> fn = vm.$options.methods &amp;&amp; vm.$options.methods[expr];</span><br><span class="line">        node.addEventListener(eventName,fn.bind(vm),<span class="literal">false</span>); <span class="comment">//绑定this指向</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//更新的对象</span></span><br><span class="line">    updater:&#123;</span><br><span class="line">        textUpdater(node,value)&#123;</span><br><span class="line">            node.textContent = value;</span><br><span class="line">        &#125;,</span><br><span class="line">        htmlUpdater(node,value)&#123;</span><br><span class="line">            <span class="comment">//console.log(value);</span></span><br><span class="line">            node.innerHTML = value;</span><br><span class="line">        &#125;,</span><br><span class="line">        modelUpdater(node,value)&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(value);</span><br><span class="line">            node.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><ol>
<li>dep作为watcher和observer的中间者，在new watcher时，把目前的watcher保存起来，在new watcher时，由于会get值，触发observer拦截，将保存起来的watcher放入dep中</li>
<li>由于每一个节点都需要watcher，所以在对每个节点执行编译时，添加watcher</li>
<li>由于设置的代理只有data，所以只有data中的数据才有响应式</li>
<li>并且只有在节点中使用的数据，才被加入了watcher，没有使用的数据，是不会被加入watcher的。</li>
</ol>
<h4 id="学习时的疑惑"><a href="#学习时的疑惑" class="headerlink" title="学习时的疑惑"></a>学习时的疑惑</h4><ol>
<li><p>为什么在Compile时，new  watcher</p>
<p>因为compile是每一个节点都会经历的步骤</p>
</li>
<li><p>为什么在get时，收集watcher？</p>
<p>因为初始化时，会进行一次get，因为在第一次编译时，new watcher，只要new watcher就会get数据</p>
</li>
<li><p>在new watcher时，获取数据</p>
</li>
</ol>
<hr>
<p><strong><em>End</em></strong></p>
<p><strong><em>by wind-jyf</em></strong></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/wind-jyf" target="_blank" rel="noopener">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#实现一个简易的Vue"><span class="toc-number">1.</span> <span class="toc-text">实现一个简易的Vue</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#HTML文件引入"><span class="toc-number">1.0.0.1.</span> <span class="toc-text">HTML文件引入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MVue入口"><span class="toc-number">1.0.0.2.</span> <span class="toc-text">MVue入口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Observer"><span class="toc-number">1.0.0.3.</span> <span class="toc-text">Observer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dep"><span class="toc-number">1.0.0.4.</span> <span class="toc-text">dep</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#watcher"><span class="toc-number">1.0.0.5.</span> <span class="toc-text">watcher</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Compile"><span class="toc-number">1.0.0.6.</span> <span class="toc-text">Compile</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#compileUtil"><span class="toc-number">1.0.0.6.1.</span> <span class="toc-text">compileUtil</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#总结"><span class="toc-number">1.0.0.7.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#学习时的疑惑"><span class="toc-number">1.0.0.8.</span> <span class="toc-text">学习时的疑惑</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/" target="_blank" rel="noopener"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&text=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&is_video=false&description=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【Vue源码】实现一个简易的Vue&body=Check out this article: http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&title=【Vue源码】实现一个简易的Vue" target="_blank" rel="noopener"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2020/04/06/%E3%80%90Vue%E6%BA%90%E7%A0%81%E3%80%91%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E6%98%93%E7%9A%84Vue/&name=【Vue源码】实现一个简易的Vue&description=" target="_blank" rel="noopener"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 wind-jyf
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/wind-jyf" target="_blank" rel="noopener">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<link rel="stylesheet" href="/lib/meslo-LG/styles.css">


<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">



<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


